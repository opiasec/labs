FROM docker:25.0.3-dind

# Instala dependências
RUN apk add --no-cache bash curl unzip git python3

ENV APP_URL=http://localhost:3000

# Instala Nuclei (binário estático)
RUN wget -q https://github.com/projectdiscovery/nuclei/releases/latest/download/nuclei_3.4.4_linux_amd64.zip && \
    unzip nuclei_3.4.4_linux_amd64.zip && \
    mv nuclei /usr/local/bin/ && \
    chmod +x /usr/local/bin/nuclei && \
    rm -f nuclei_*.zip

# Copia seu script
WORKDIR /app
COPY evaluate.py .
COPY entrypoint.sh .
RUN chmod +x /app/entrypoint.sh

ENTRYPOINT [ "/app/entrypoint.sh" ]